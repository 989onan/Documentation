

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>UFunction &mdash; Satisfactory Modding Documentation  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon-32x32.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="UClass" href="UClass.html" />
    <link rel="prev" title="UStruct" href="UStruct.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Satisfactory Modding Documentation
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../beginners_guide/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">SML</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../SPL/index.html">Satisfactory Pak Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SDK/index.html">Satisfactory Development Kit</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Blue-Print Interface</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#the-problem">The Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#the-solution">The Solution</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#general">General</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="UObject.html">UObject</a></li>
<li class="toctree-l4"><a class="reference internal" href="UField.html">UField</a></li>
<li class="toctree-l4"><a class="reference internal" href="UProperty.html">UProperty</a></li>
<li class="toctree-l4"><a class="reference internal" href="UStruct.html">UStruct</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">UFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="UClass.html">UClass</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#mod-types">Mod “Types”</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Satisfactory Modding Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">SML</a> &raquo;</li>
        
          <li><a href="index.html">Blue-Print Interface</a> &raquo;</li>
        
      <li>UFunction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/SML/BPI/UFunction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ufunction">
<h1>UFunction<a class="headerlink" href="#ufunction" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="UFunction">UFunctions</a> are <a class="reference external" href="UStruct">UStructs</a> containing information about a function of a class.
Each function contains a name, flags and again some children as well as eventually a native function pointer if it is a native function.</p>
<div class="section" id="children">
<h2>Children<a class="headerlink" href="#children" title="Permalink to this headline">¶</a></h2>
<p>These children (of the base class <a class="reference external" href="UStruct">UStruct</a>) describe which input parameters, output parameters and return value this function has.</p>
</div>
<div class="section" id="invoking">
<h2>Invoking<a class="headerlink" href="#invoking" title="Permalink to this headline">¶</a></h2>
<p>You can invoke a <a class="reference internal" href="#ufunction">UFunction</a> through two main ways.</p>
<ol class="arabic">
<li><p>Using the <code class="docutils literal notranslate"><span class="pre">invoke</span></code>-function of the <a class="reference internal" href="#ufunction">UFunction</a></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">UObject</span><span class="o">*</span> <span class="n">obj</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">ParameterStruct</span><span class="p">;</span>
<span class="n">UFunction</span><span class="o">*</span> <span class="n">func</span><span class="p">;</span>
<span class="n">ParamterStruct</span> <span class="n">params</span><span class="p">;</span>

<span class="n">func</span><span class="o">-&gt;</span><span class="n">invoke</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>Using the <code class="docutils literal notranslate"><span class="pre">processEvent</span></code>-function of <a class="reference external" href="UObject">UObject</a></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">UObject</span><span class="o">*</span> <span class="n">obj</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">ParameterStruct</span><span class="p">;</span>
<span class="n">UFunction</span><span class="o">*</span> <span class="n">func</span><span class="p">;</span>
<span class="n">ParamterStruct</span> <span class="n">params</span><span class="p">;</span>

<span class="n">obj</span><span class="o">-&gt;</span><span class="n">processEvent</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="paramterstruct">
<h2>ParamterStruct<a class="headerlink" href="#paramterstruct" title="Permalink to this headline">¶</a></h2>
<p>All parameters the given function has, need to get a place in a structure, the so-called “Parameter Structure” (aka. “ParamStruct”)
This structure is simply all C++ types given through the <a class="reference external" href="UProperty">UPropertys</a> in a row.</p>
<p>This example shows a param struct for a <code class="docutils literal notranslate"><span class="pre">FVector</span></code> and an <a class="reference external" href="UObject">UObject</a>-ref as input, a <code class="docutils literal notranslate"><span class="pre">bool</span></code> as an output parameter and an <code class="docutils literal notranslate"><span class="pre">int</span></code> as a return value.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">paramStruct</span> <span class="p">{</span>
    <span class="n">FVector</span> <span class="n">vectorInput</span><span class="p">;</span>
    <span class="n">UObject</span><span class="o">*</span> <span class="n">otherObj</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">worked</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">count</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="flags">
<h2>Flags<a class="headerlink" href="#flags" title="Permalink to this headline">¶</a></h2>
<p>The Function-Flags provide the ability to define different kinds of functions like abstract functions, static function or just member functions.
These flags work as register, each bit of the integer is a different flag.
To check, set or unset a flag use the bitwise <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> (and), <code class="docutils literal notranslate"><span class="pre">|</span></code> (or) and <code class="docutils literal notranslate"><span class="pre">~</span></code> (negate) operators.</p>
</div>
<div class="section" id="native-exec-function">
<h2>Native Exec-Function<a class="headerlink" href="#native-exec-function" title="Permalink to this headline">¶</a></h2>
<p>The native execution function gets called when the <a class="reference internal" href="#ufunction">UFunction</a> get invoked.
The native function needs to be static and gets a <a class="reference external" href="UObject">UObject</a>-ptr as context object, an FFrame-ref, to get and set parameters and also to increase the code pointer, and a pointer to the Return-Value-Structure (a struct containing all return values, not out params).
This means your exec-function declaration needs to look like <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">void</span> <span class="pre">execFuncName(UObject*</span> <span class="pre">obj,</span> <span class="pre">FFrame&amp;</span> <span class="pre">stack,</span> <span class="pre">void*</span> <span class="pre">retVals)</span></code></p>
<div class="section" id="input-params">
<h3>Input Params<a class="headerlink" href="#input-params" title="Permalink to this headline">¶</a></h3>
<p>The stack (or FFrame) is used to give access to the execution and value flow.
Getting parameters (in and out) depends on the order given in the building of the UFunction.
To get a value you simply need to allocate a space where the input can get copied to, and after that, you just give the pointer to the location the <code class="docutils literal notranslate"><span class="pre">stepCompIn</span></code> function which gets the input param and stores it in that pointer.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">execFunc</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">FFrame</span><span class="o">&amp;</span> <span class="n">stack</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">FString</span> <span class="n">input1</span><span class="p">;</span>
    <span class="n">FString</span> <span class="n">input2</span><span class="p">;</span>
    <span class="n">frame</span><span class="p">.</span><span class="n">stepCompIn</span><span class="p">(</span><span class="o">&amp;</span><span class="n">input1</span><span class="p">);</span>
    <span class="n">frame</span><span class="p">.</span><span class="n">stepCompIn</span><span class="p">(</span><span class="o">&amp;</span><span class="n">input2</span><span class="p">);</span>

    <span class="c1">// other stuff</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="output-params">
<h3>Output Params<a class="headerlink" href="#output-params" title="Permalink to this headline">¶</a></h3>
<p>Output params are very similar to the input parameters with one key difference: You use the <code class="docutils literal notranslate"><span class="pre">stepCompInRef</span></code> function which takes again a pointer to allocated storage for the value but this time it also returns a reference, and to set the final value you just need to set the reference.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">execFunc</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">FFrame</span><span class="o">&amp;</span> <span class="n">stack</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">FString</span> <span class="n">out1_temp</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">out2_temp</span><span class="p">;</span>
    <span class="n">FString</span><span class="o">&amp;</span> <span class="n">out1</span> <span class="o">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">stepCompInRef</span><span class="p">(</span><span class="o">&amp;</span><span class="n">out1_temp</span><span class="p">);</span>
    <span class="kt">int</span><span class="o">&amp;</span> <span class="n">out2</span> <span class="o">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">stepCompInRef</span><span class="p">(</span><span class="o">&amp;</span><span class="n">out2_temp</span><span class="p">);</span>

    <span class="c1">// other stuff</span>

    <span class="n">out1</span> <span class="o">=</span> <span class="s">&quot;nice&quot;</span><span class="p">;</span>
    <span class="n">out2</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="return-values">
<h3>Return Values<a class="headerlink" href="#return-values" title="Permalink to this headline">¶</a></h3>
<p>The retval pointer is passed with a valid pointer to allocated space for the return values.
To set those, just simply set the values of the struct pointed to.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">RetVals</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">retVal1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">execFunc</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">FFrame</span><span class="o">&amp;</span> <span class="n">stack</span><span class="p">,</span> <span class="n">RetVals</span><span class="o">*</span> <span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// other stuff</span>

    <span class="n">ret</span><span class="o">-&gt;</span><span class="n">retVal1</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="code-counter">
<h3>Code Counter<a class="headerlink" href="#code-counter" title="Permalink to this headline">¶</a></h3>
<p>When the exec function gets executed you should increment the code counter of the stack after you get the params. If the current code counter is nullptr, just leave it as it is.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">execFunc</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">FFrame</span><span class="o">&amp;</span> <span class="n">stack</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// params</span>

    <span class="n">stack</span><span class="p">.</span><span class="n">code</span> <span class="o">+=</span> <span class="o">!!</span><span class="n">stack</span><span class="p">.</span><span class="n">code</span><span class="p">;</span>

    <span class="c1">// other stuff</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="building">
<h2>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<p>The BPI provides the <code class="docutils literal notranslate"><span class="pre">SML::Paks::FunctionBuilder</span></code>-Class in <code class="docutils literal notranslate"><span class="pre">assets/BPInterface.h</span></code> for easy declaring and defining custom <a class="reference external" href="UFunction">UFunctions</a>.</p>
<p>The class contains for each basic type of function a static initialize function.</p>
<ul class="simple">
<li><dl class="simple">
<dt>static</dt><dd><p>Use this for static functions (f.e. in Blueprint Function Libraries).
You will get in the execution function the default object as a context object.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>member</dt><dd><p>Use this for member functions (f.e. in actors who need the context of the actor to work properly). You get the “this” object in the execute-function as a context object.</p>
</dd>
</dl>
</li>
</ul>
<p>As you will see, the function takes the name of the new function as a parameter.</p>
<div class="section" id="native-function">
<h3>Native-Function<a class="headerlink" href="#native-function" title="Permalink to this headline">¶</a></h3>
<p>If your UFunction should get linked to a native execution function use the provided <code class="docutils literal notranslate"><span class="pre">native</span></code> to set the function pointer and the needed function-flags.</p>
</div>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<p>To add a <a class="reference external" href="UProperty">UProperty</a> use <code class="docutils literal notranslate"><span class="pre">param</span></code> and pass the property builder.
If your property needs an offset value, and you don’t provide one, the builder will get the last property and uses its offset and dimension to get the new offset.
If there is no previous property, it uses 0 as offset and 0 as dimension.</p>
</div>
<div class="section" id="id2">
<h3>Flags<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>The builder class provides the <code class="docutils literal notranslate"><span class="pre">addFlag</span></code> and <code class="docutils literal notranslate"><span class="pre">removeFlag</span></code> methods for manipulating the function flag register.</p>
</div>
<div class="section" id="finishing">
<h3>Finishing<a class="headerlink" href="#finishing" title="Permalink to this headline">¶</a></h3>
<p>To finish building just call the <code class="docutils literal notranslate"><span class="pre">build</span></code> function of the builder class. If you use the function in f.e. the ClassBuilder, you just give it the unbuild <code class="docutils literal notranslate"><span class="pre">FunctionBuilder</span></code></p>
</div>
<div class="section" id="attaching">
<h3>Attaching<a class="headerlink" href="#attaching" title="Permalink to this headline">¶</a></h3>
<p>You’re also able to attach a new custom <a class="reference internal" href="#ufunction">UFunction</a> to an existing <a href="#id3"><span class="problematic" id="id4">`UClass`_</span></a> with the <code class="docutils literal notranslate"><span class="pre">attach</span></code> function. The class will get properly built by the builder class when needed.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="UClass.html" class="btn btn-neutral float-right" title="UClass" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="UStruct.html" class="btn btn-neutral float-left" title="UStruct" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, SatisfactoryModding

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>